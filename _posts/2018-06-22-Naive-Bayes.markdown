---
layout:     post
title:      "朴素贝叶斯"
subtitle:   "Naive Bayes"
header-img: "img/post-bg-js-version.jpg"
date:       2018-06-22
author:     "Linzb"
tags:
    - 机器学习
    - Naive Bayes
---
# 朴素贝叶斯
在所有的机器学习分类算法中，朴素贝叶斯和其他绝大多数的分类算法都不同。对于大多数的分类算法，比如决策树,KNN,逻辑回归，支持向量机等，他们都是判别方法，也就是直接学习出特征输出Y和特征X之间的关系，要么是决策函数Y=f(X),要么是条件分布P(Y|X)。但是朴素贝叶斯却是生成方法，也就是直接找出特征输出Y和特征X的联合分布P(X,Y),然后用 P(Y|X)=P(X,Y)/P(X) 得出。

朴素贝叶斯很直观，计算量也不大，在很多领域有广泛的应用，这里我们就对朴素贝叶斯算法原理做一个小结。
## 零、条件概率、贝叶斯公式
我们先看看条件独立公式，如果X和Y相互独立，则有：
```
P(X,Y)=P(X)P(Y)
```
我们接着看看条件概率公式：
```
P(Y|X)=P(X,Y)/P(X)
P(X|Y)=P(X,Y)/P(Y)
```
或者说:
```
P(Y|X)=P(X|Y)P(Y)/P(X)
```
接着看看全概率公式
```
P(X) = ∑kP(X|Y=Yk)P(Yk)  其中∑kP(Yk)=1，k为下标
```
从上面的公式很容易得出贝叶斯公式：
```
P(Yk|X) = P(X|Yk)P(Yk) /  ∑kP(X|Y=Yk)P(Yk)  其中k为下标
```


##  一、朴素贝叶斯的模型
朴素贝叶斯是一种构建分类器的简单方法。所有朴素贝叶斯分类器都假定样本每个特征与其他特征都不相关。举个例子，如果一种水果其具有红，圆，直径大概3英寸等特征，该水果可以被判定为是苹果。尽管这些特征相互依赖或者有些特征由其他特征决定，然而朴素贝叶斯分类器认为这些属性在判定该水果是否为苹果的概率分布上独立的。

尽管是带着这些朴素思想和过于简单化的假设，但朴素贝叶斯分类器在很多复杂的现实情形中仍能够获取相当好的效果。朴素贝叶斯分类器的一个优势在于只需要根据少量的训练数据估计出必要的参数。由于变量独立假设，只需要估计各个变量的方法，而不需要确定整个协方差矩阵。


从统计学知识回到我们的数据分析。假如我们的分类模型样本是某个体有n项特征（Feature），分别为F1、F2、...、Fn。现有m个类别（Category），分别为C1、C2、...、Cm。贝叶斯分类器就是计算出概率最大的那个分类，也就是求下面这个算式的最大值：
```
　P(C|F1F2...Fn) = P(F1F2...Fn|C)P(C) / P(F1F2...Fn)
```
由于 P(F1F2...Fn) 对于所有的类别都是相同的，可以省略，问题就变成了求
```
　P(F1F2...Fn|C)P(C)
```
的最大值。
朴素贝叶斯分类器则是更进一步，假设所有特征都彼此独立，因此
```
　P(F1F2...Fn|C)P(C) = P(F1|C)P(F2|C) ... P(Fn|C)P(C)
```
上式等号右边的每一项，都可以从统计资料中得到，由此就可以计算出每个类别对应的概率，从而找出最大概率的那个类。

从上式可以看出，这个很难的条件分布大大的简化了，但是这也可能带来预测的不准确性。特征之间非常不独立怎么办？如果真是非常不独立的话，那就尽量不要使用朴素贝叶斯模型了，考虑使用其他的分类方法比较好。但是一般情况下，样本的特征之间独立这个条件的确是弱成立的，尤其是数据量非常大的时候。虽然我们牺牲了准确性，但是得到的好处是模型的条件分布的计算大大简化了，这就是贝叶斯模型的选择。




## 二、朴素贝叶斯的参数估计
拉普拉斯平滑


## 三、参考

[朴素贝叶斯算法原理小结](http://www.cnblogs.com/pinard/p/6069267.html)

[朴素贝叶斯分类器-维基百科](https://zh.wikipedia.org/wiki/朴素贝叶斯分类器)

[阮一峰的网络日志:贝叶斯推断及其互联网应用（一）：定理简介](http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_one.html)

[阮一峰的网络日志:贝叶斯推断及其互联网应用（二）：过滤垃圾邮件](http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_two.html)

[阮一峰的网络日志:贝叶斯推断及其互联网应用（三）：拼写检查](http://www.ruanyifeng.com/blog/2012/10/spelling_corrector.html)

[阮一峰的网络日志:朴素贝叶斯分类器的应用](http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html)
